{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "The display name of the user."
        },
        "photoURL": {
          "type": "string",
          "description": "URL of the user's profile photo.",
          "format": "uri"
        },
        "creationTime": {
          "type": "string",
          "description": "Timestamp of when the user account was created.",
          "format": "date-time"
        },
        "lastSignInTime": {
          "type": "string",
          "description": "Timestamp of the user's last sign-in.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email"
      ]
    },
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a project in the portfolio.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Project entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Project)"
        },
        "title": {
          "type": "string",
          "description": "The title of the project."
        },
        "oneLiner": {
          "type": "string",
          "description": "A brief description of the project."
        },
        "techStack": {
          "type": "array",
          "description": "An array of technologies used in the project.",
          "items": {
            "type": "string"
          }
        },
        "liveDemoUrl": {
          "type": "string",
          "description": "URL to the live demo of the project.",
          "format": "uri"
        },
        "githubUrl": {
          "type": "string",
          "description": "URL to the GitHub repository of the project.",
          "format": "uri"
        },
        "logoUrl": {
          "type": "string",
          "description": "URL to the project's logo or image.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "userId",
        "title"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. Only the authenticated user can read/write their own document.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user, matching the Firebase Auth UID."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/projects/{projectId}",
        "definition": {
          "entityName": "Project",
          "schema": {
            "$ref": "#/backend/entities/Project"
          },
          "description": "Stores project data. Includes denormalized 'userId' field for authorization independence, ensuring only the project owner can access the data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user (project owner)."
            },
            {
              "name": "projectId",
              "description": "The unique identifier for the project."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore data structure is designed to support the \"Chancellor Minus - AI Portfolio\" application, focusing on secure access, scalability, and maintainability. The key principle is Authorization Independence, achieved through denormalization. This eliminates the need for `get()` calls in security rules, enabling atomic operations and simplified debugging.\n\n*   **User Data:** User profiles are stored under `/users/{userId}`.  This path-based ownership ensures only the authenticated user can access their data.\n*   **Project Data:** Projects are stored as subcollections of users (`/users/{userId}/projects/{projectId}`). The `userId` field is denormalized inside each project document, enabling secure and efficient `list` operations and enforcing ownership.\n\nThis structure segregates user data and project data into separate paths with clear ownership. This avoids mixing data with different security needs in the same collection.  Authorization is simplified by relying on path-based ownership and denormalized data, making the rules more robust and easier to understand. No custom claims are used, relying instead on `request.auth.uid` for authorization. Roles must be stored in the database."
  }
}